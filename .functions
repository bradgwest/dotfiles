#!/bin/bash

# ISO08061 UTC timestamp
timestamp() {
  date --utc +"%FZ%TZ"
}

# Write a notes taker
note() {
  # if $NOTES doesn't exist, then error
  if [ -z "${NOTES}" ]; then
    echo "Please set NOTES env variable"
    exit 1
  fi

  if ! (($#)); then
    # no args, tail
    tail $NOTES
  else
    # add all args to the file
    printf "$(timestamp) %s\n" "$*" >> $NOTES
  fi
}


# cd and ls in one
cl() {
  local dir="$1"
  local dir="${dir:=$HOME}"
  if [[ -d "$dir" ]]; then
    cd "$dir" >/dev/null; ls
  else
    echo "bash: cl: $dir: Directory not found"
  fi
}

# calculator
calc() {
    echo "scale=3;$@" | bc -l
}

# Take a TODO note in cwd
todo() {
    if [[ ! -f .todo ]]; then
        touch .todo
    fi

    if ! (($#)); then
        cat .todo
    elif [[ "$1" == "-l" ]]; then
        nl -b a .todo
    elif [[ "$1" == "-c" ]]; then
        > .todo
    elif [[ "$1" == "-r" ]]; then
        nl -b a .todo
        eval printf %.0s- '{1..'"${COLUMNS:-$(tput cols)}"\}; echo
        read -p "Type a number to remove: " number
        sed -i ${number}d .todo .todo
    else
        printf "$(timestamp) %s\n" "$*" >> .todo
    fi
}

